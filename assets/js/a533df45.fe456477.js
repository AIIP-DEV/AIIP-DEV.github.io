"use strict";(self.webpackChunktestdocu=self.webpackChunktestdocu||[]).push([[1263],{3905:(e,n,r)=>{r.d(n,{Zo:()=>d,kt:()=>f});var t=r(67294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=t.createContext({}),s=function(e){var n=t.useContext(p),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},d=function(e){var n=s(e.components);return t.createElement(p.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(r),m=a,f=c["".concat(p,".").concat(m)]||c[m]||u[m]||o;return r?t.createElement(f,i(i({ref:n},d),{},{components:r})):t.createElement(f,i({ref:n},d))}));function f(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"},14354:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var t=r(83117),a=(r(67294),r(3905));const o={},i="Sandbox Template Architecture",l={unversionedId:"Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_file_architecture",id:"Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_file_architecture",title:"Sandbox Template Architecture",description:"* \uc0cc\ub4dc\ubc15\uc2a4 \ud15c\ud50c\ub9bf\uc5d0\ub294 \uc0ac\uc6a9\uc790\uac00 \uc790\uc2e0\uc758 \ubaa8\ub378\uc744 \ud6c8\ub828\ud558\uace0 \uc774\ub97c \ubc30\ud3ec\ud560 \uc218 \uc788\ub294 \ucee4\uc2a4\ud140 \ucf54\ub4dc\uac00 \uc900\ube44\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.",source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_file_architecture.md",sourceDirName:"Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template",slug:"/Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_file_architecture",permalink:"/accu30/docs/Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_file_architecture",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"accuSidebar",previous:{title:"JupyterLab \ud655\uc7a5",permalink:"/accu30/docs/Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/jupyterext"},next:{title:"PyTorch Template",permalink:"/accu30/docs/Accuinsight3.0/\uc6cc\ud06c\ud50c\ub85c\uc6b0/Pyspark \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud654\uba74/\ubaa8\ub378\ub9c1/\uc0cc\ub4dc\ubc15\uc2a4/Sandbox Template/sandbox_jupyter_pytorch"}},p={},s=[{value:"\uc544\ud0a4\ud14d\uccd0 \uc18c\uac1c",id:"\uc544\ud0a4\ud14d\uccd0-\uc18c\uac1c",level:2},{value:"\ubaa8\ub378 \uc0dd\uc131 \uc608\uc2dc",id:"\ubaa8\ub378-\uc0dd\uc131-\uc608\uc2dc",level:2},{value:"<code>trainer</code>: Training Module",id:"trainer-training-module",level:3},{value:"Components",id:"components",level:3},{value:"<code>trainer.model</code>: Model Defining",id:"trainermodel-model-defining",level:3},{value:"<code>trainer.__main__</code>: Runnable for Training",id:"trainer__main__-runnable-for-training",level:3},{value:"<code>inferencer</code>: Inference Module",id:"inferencer-inference-module",level:3},{value:"<code>inferencer.model</code>: Model Defining",id:"inferencermodel-model-defining",level:3}],d={toc:s},c="wrapper";function u(e){let{components:n,...r}=e;return(0,a.kt)(c,(0,t.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"sandbox-template-architecture"},"Sandbox Template Architecture"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\uc0cc\ub4dc\ubc15\uc2a4 \ud15c\ud50c\ub9bf\uc5d0\ub294 \uc0ac\uc6a9\uc790\uac00 \uc790\uc2e0\uc758 \ubaa8\ub378\uc744 \ud6c8\ub828\ud558\uace0 \uc774\ub97c \ubc30\ud3ec\ud560 \uc218 \uc788\ub294 \ucee4\uc2a4\ud140 \ucf54\ub4dc\uac00 \uc900\ube44\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\uc0cc\ub4dc\ubc15\uc2a4 \ub178\ub4dc\ub97c \uc0dd\uc131\ud55c \ub4a4 Jupyter Lab\uc5d0 \uc811\uc18d\ud558\uba74 \uc88c\uce21\uc758 \ud574\ub2f9 \ud30c\uc77c \uad6c\uc870\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."))),(0,a.kt)("h5",{id:""}),(0,a.kt)("h2",{id:"\uc544\ud0a4\ud14d\uccd0-\uc18c\uac1c"},"\uc544\ud0a4\ud14d\uccd0 \uc18c\uac1c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Project\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 model.Dockerfile  <-------------------------- \ube4c\ub4dc\uc5d0 \uc0ac\uc6a9\ub418\ub294 \ub3c4\ucee4\ud30c\uc77c\n\u251c\u2500\u2500 modelserver\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 inferencer\n\u2502   \u2514\u2500\u2500 trainer\n\u251c\u2500\u2500 run_modelserver   <-------------------------- \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108\uc758 Entrypoint\n\u2514\u2500\u2500 setup.py\n\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"modelserver"),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre"},"${framework}server\n\u251c\u2500\u2500 models/ <------------------------------------ \uc0d8\ud50c Pre-built \ubaa8\ub378 \ud30c\uc77c\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 inferencer        <-------------------------- API\ub97c \ud1b5\ud55c \ubaa8\ub378 \uc608\uce21 \uc2e4\ud589\ubd80\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 __main__.py   \n\u2502   \u251c\u2500\u2500 model.py      <-------------------------- KFServing\uc5d0\uc11c \uc0c1\uc18d\ubc1b\uc740 \ubaa8\ub378\n\u2502   \u251c\u2500\u2500 model_repository.py  <------------------- \ubaa8\ub378 \uc608\uce21\uc744 \uc704\ud574 \ubaa8\ub378 \ubd88\ub7ec\uc624\uae30\n\u2502   \u251c\u2500\u2500 test_model.py\n\u2502   \u2514\u2500\u2500 test_model_repository.py\n\u2514\u2500\u2500 trainer           <-------------------------- \ubaa8\ub378\uc744 \uc815\uc758\ud558\uace0 \ud6c8\ub828\uc2dc\ud0a4\ub294 \ud30c\uc77c\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 __main__.py   <-------------------------- \ud6c8\ub828\uc744 \uc704\ud55c \uc2e4\ud589\ubd80(optional)\n    \u251c\u2500\u2500 config.py       <------------------------ \ud658\uacbd\ubcc0\uc218, \uc124\uc815\ud30c\uc77c\n    \u251c\u2500\u2500 model.py      <-------------------------- \ud6c8\ub828\uc744 \uc704\ud55c \ubaa8\ub378 \n    \u251c\u2500\u2500 postprocessor.py  <---------------------- \ud6c4\ucc98\ub9ac \ubaa8\ub4c8\n    \u251c\u2500\u2500 preprocessor.py   <---------------------- \uc804\ucc98\ub9ac \ubaa8\ub4c8\n    \u2514\u2500\u2500 utils.py         <----------------------- \uc720\ud2f8\ub9ac\ud2f0 \ubaa8\ub4c8\n"))),(0,a.kt)("h5",{id:"-1"}),(0,a.kt)("h2",{id:"\ubaa8\ub378-\uc0dd\uc131-\uc608\uc2dc"},"\ubaa8\ub378 \uc0dd\uc131 \uc608\uc2dc"),(0,a.kt)("h3",{id:"trainer-training-module"},(0,a.kt)("inlineCode",{parentName:"h3"},"trainer"),": Training Module"),(0,a.kt)("p",null,"trainer \ubaa8\ub4c8\uc740 Sandbox Template\uc5d0\uc11c \ubaa8\ub378\uc744 \uc815\uc758\ud558\uace0, \ud6c8\ub828\uae4c\uc9c0 \ub2f4\ub2f9\ud558\ub294 \ubaa8\ub4c8\uc785\ub2c8\ub2e4."),(0,a.kt)("h5",{id:"-2"}),(0,a.kt)("h3",{id:"components"},"Components"),(0,a.kt)("p",null,"\ucef4\ud3ec\ub10c\ud2b8 \uad6c\uc131\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Model itself \ubaa8\ub378"),(0,a.kt)("li",{parentName:"ul"},"Pre-processing \uc804\ucc98\ub9ac \ubd80"),(0,a.kt)("li",{parentName:"ul"},"Post-processing \ud6c4\ucc98\ub9ac \ubd80"),(0,a.kt)("li",{parentName:"ul"},"Architecture \uad6c\uc870\ub294 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"trainer\n\u251c\u2500\u2500 config.py\n\u251c\u2500\u2500 _core.py\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 __main__.py\n\u251c\u2500\u2500 model.py\n\u251c\u2500\u2500 postprocessor.py\n\u251c\u2500\u2500 preprocessor.py\n\u2514\u2500\u2500 utils.py\n\n")),(0,a.kt)("h5",{id:"-3"}),(0,a.kt)("h3",{id:"trainermodel-model-defining"},(0,a.kt)("inlineCode",{parentName:"h3"},"trainer.model"),": Model Defining"),(0,a.kt)("p",null,"\ubaa8\ub378 \uc815\uc758\ub294 \uc544\ub798 \ucf54\ub4dc\uc640 \uac19\uc774 \uad6c\uc131\ub429\ub2c8\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import utils\nimport config\nfrom .preprocessor import prep_func\nfrom .postprocessor import post_func\n\nclass MyModel(object):\n    def __init__(self,  dirpath=None, *args, **kwargs):\n        if dirpath:\n            self.load(dirpath)\n        else:\n            try:\n                self.build(*args, **kwargs)\n            except TypeError as e:\n                raise e\n\n        self.config = ...\n\n    def preprocess(self, X):\n        return prep_func(X)\n\n    def postprocess(self, y_hat):\n        return post_func(y_hat)\n\n    def build(self, *args, **kwargs):\n        # =========================================== #\n        self.model = ...\n        # =========================================== #\n\n    def train(self, X, y, *args, **kwargs):\n        self.model.fit(X, y)\n\n    def evaluate(self, X, y, *args, **kwargs):\n        X = self.preprocess(X)\n        y_hat = self.model.evaluate(X, y)\n        return self.postprocess(y_hat)\n\n    def predict(self, X, *args, **kwargs):\n        X = self.preprocess(X)\n        y_hat = self.model.predict(X)\n        return self.postprocess(y_hat)\n\n    def save(self, dirpath, *args, **kwargs):\n        self.model.save_model(dirpath)\n\n    def load(self, dirpath, *args, **kwargs):\n        self.model.load_model(dirpath)\n")),(0,a.kt)("h5",{id:"-4"}),(0,a.kt)("h3",{id:"trainer__main__-runnable-for-training"},(0,a.kt)("inlineCode",{parentName:"h3"},"trainer.__main__"),": Runnable for Training"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import numpy as np\nfrom sklearnserver.trainer.model import MyModel\n\ntrain_x, train_y = ...\neval_x, eval_y = ...\n\nmodel = MyModel(...)\nmodel1.train(train_x, train_y)\n\neval_res = model.evaluate(eval_x, eval_y)\nprint(eval_res)\n")),(0,a.kt)("h5",{id:"-5"}),(0,a.kt)("h3",{id:"inferencer-inference-module"},(0,a.kt)("inlineCode",{parentName:"h3"},"inferencer"),": Inference Module"),(0,a.kt)("p",null,"inferencer \ubaa8\ub4c8\uc740 Sandbox Template \uc5d0\uc11c \ubaa8\ub378 \ubc30\ud3ec, \uc608\uce21\uc744 \ub2f4\ub2f9\ud558\ub294 \ubaa8\ub4c8\uc785\ub2c8\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"inferencer\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 __main__.py\n\u251c\u2500\u2500 model.py\n\u251c\u2500\u2500 model_repository.py\n\u251c\u2500\u2500 test_model.py\n\u2514\u2500\u2500 test_model_repository.py\n\n")),(0,a.kt)("h5",{id:"-6"}),(0,a.kt)("h3",{id:"inferencermodel-model-defining"},(0,a.kt)("inlineCode",{parentName:"h3"},"inferencer.model"),": Model Defining"),(0,a.kt)("p",null,"inferencer \uc815\uc758\ub294 KFServing\uc758 \ubaa8\ub4c8\uc744 \uc0c1\uc18d\ubc1b\uc544 \uc815\uc758\ub429\ub2c8\ub2e4."),(0,a.kt)("p",null,"trainer\uc5d0\uc11c \uc815\uc758\ud55c \ubaa8\ub378\uc744 \ub85c\ub4dc\ud558\uc5ec \uc608\uce21\ud558\ub294 \ub370 \uc0ac\uc6a9\ud569\ub2c8\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from sklearnserver.trainer.model import MyModel\n\n# KFModel: tornado based; REST, GRPC support\nclass ServingModel(kfserving.KFModel):\n    def __init__(self, name: str, model_dir: str):\n        ...\n\n    def load(self) -> bool:\n        model_path = kfserving.Storage.download(self.model_dir)\n        # =========================================== #\n        self._model = MyModel(dirpath=model_path)\n        # =========================================== #\n        self.ready = True\n        return self.ready\n\n    def predict(self, request: Dict) -> Dict:\n        instances = request["instances"]\n        inputs = np.array(instances)\n        result = self._model.predict(inputs).tolist()\n        return {"predictions": result}\n')))}u.isMDXComponent=!0}}]);